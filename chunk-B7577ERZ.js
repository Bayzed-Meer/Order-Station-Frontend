import{a as x}from"./chunk-73G7AXVQ.js";import{a as z}from"./chunk-QXHIHSTA.js";import{A as v,Oa as U,Ta as H,Ua as J,Va as K,Wa as Q,Xa as W,Za as X,ab as Y,bb as ee,cb as te,db as ne,j as k,l as g,o as q,p as D,pa as Z,qa as $,ra as j,t as R,v as A,w as V,x as B,y as G,z as L}from"./chunk-JKOZUD4R.js";import{$b as N,Bb as d,Cb as o,D as F,Db as f,Eb as u,Fb as p,Fc as I,Kb as C,Mb as _,Ub as a,Vb as b,W as P,Wa as s,a as S,da as w,ha as E,p as y,pb as l,rb as h,wb as c,za as O,zc as T}from"./chunk-EBQJBUXN.js";function ie(e,t){e&1&&(u(0),a(1,"Email is required."),p())}function oe(e,t){e&1&&(u(0),a(1," Please enter a valid email address. "),p())}function ae(e,t){if(e&1&&(d(0,"mat-error"),l(1,ie,2,0,"ng-container")(2,oe,2,0,"ng-container"),o()),e&2){let i,r=_();s(),c((i=r.changePasswordForm.get("email").errors)!=null&&i.required?1:(i=r.changePasswordForm.get("email").errors)!=null&&i.email?2:-1)}}function re(e,t){e&1&&(u(0),a(1,"Current Password is required"),p())}function se(e,t){if(e&1&&(d(0,"mat-error"),l(1,re,2,0,"ng-container"),o()),e&2){let i,r=_();s(),c((i=r.changePasswordForm.get("currentPassword").errors)!=null&&i.required?1:-1)}}function de(e,t){e&1&&(u(0),a(1," Password is required. "),p())}function me(e,t){e&1&&(u(0),a(1,"Password must be at least 8 characters long."),p())}function le(e,t){e&1&&(u(0),a(1,"Password cannot exceed 32 characters."),p())}function ce(e,t){e&1&&(u(0),a(1,"Password must include A-Z, a-z, 0-9, and special character."),p())}function ue(e,t){if(e&1&&(d(0,"mat-error"),l(1,de,2,0,"ng-container")(2,me,2,0,"ng-container")(3,le,2,0,"ng-container")(4,ce,2,0,"ng-container"),o()),e&2){let i,r=_();s(),c((i=r.changePasswordForm.get("newPassword").errors)!=null&&i.required?1:(i=r.changePasswordForm.get("newPassword").errors)!=null&&i.minlength?2:(i=r.changePasswordForm.get("newPassword").errors)!=null&&i.maxlength?3:(i=r.changePasswordForm.get("newPassword").errors)!=null&&i.pattern?4:-1)}}function pe(e,t){e&1&&f(0,"app-spinner")}function ge(e,t){e&1&&(d(0,"span"),a(1,"Submit"),o())}var De=(()=>{let t=class t{constructor(){this.authService=w(z),this.destroyRef=w(O),this.formBuilder=w(B),this.dialog=w(U),this.loading=!1,this.role="",this.hideCurrentPassword=!0,this.hideNewPassword=!0}ngOnInit(){this.checkRole(),this.initializeForm()}checkRole(){this.authService.getRole().pipe(P(r=>this.role=r),v(this.destroyRef)).subscribe()}initializeForm(){this.changePasswordForm=this.formBuilder.group({email:["",[g.required,g.email]],currentPassword:["",g.required],newPassword:["",[g.required,g.minLength(8),g.maxLength(32),g.pattern(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,32}$/)]]})}onSubmit(){if(this.changePasswordForm.markAllAsTouched(),this.changePasswordForm.valid){this.loading=!0;let r=S({},this.changePasswordForm.value);this.authService.changePassword(r).pipe(P(m=>{this.loading=!1,x(this.dialog,m.message,"close"),this.changePasswordForm.reset()}),F(m=>(this.loading=!1,x(this.dialog,m.error.message,"close"),console.log(m),y(m))),v(this.destroyRef)).subscribe()}}toggleCurrentPasswordVisibility(){this.hideCurrentPassword=!this.hideCurrentPassword}toggleNewPasswordVisibility(){this.hideNewPassword=!this.hideNewPassword}};t.\u0275fac=function(m){return new(m||t)},t.\u0275cmp=E({type:t,selectors:[["app-change-password"]],standalone:!0,features:[N],decls:31,vars:12,consts:[[3,"ngClass"],[1,"change-password-title"],[3,"ngSubmit","formGroup"],[1,"full-width"],["matInput","","id","email","type","email","formControlName","email","placeholder","example@gmail.com"],["matInput","","id","currentPassword","formControlName","currentPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"type"],["mat-icon-button","","matIconSuffix","","type","button",1,"hideIcon",3,"click"],["matInput","","id","password","formControlName","newPassword","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"type"],["mat-flat-button","","type","submit",1,"submit-button",3,"disabled"]],template:function(m,n){m&1&&(d(0,"div",0)(1,"div",0)(2,"p",1)(3,"mat-icon"),a(4,"key"),o(),a(5," Change Password "),o(),d(6,"form",2),C("ngSubmit",function(){return n.onSubmit()}),d(7,"mat-form-field",3)(8,"mat-label"),a(9,"Email"),o(),f(10,"input",4),l(11,ae,3,1,"mat-error"),o(),d(12,"mat-form-field",3)(13,"mat-label"),a(14,"Current Password"),o(),f(15,"input",5),d(16,"button",6),C("click",function(){return n.toggleCurrentPasswordVisibility()}),d(17,"mat-icon"),a(18),o()(),l(19,se,2,1,"mat-error"),o(),d(20,"mat-form-field",3)(21,"mat-label"),a(22,"New Password"),o(),f(23,"input",7),d(24,"button",6),C("click",function(){return n.toggleNewPasswordVisibility()}),d(25,"mat-icon"),a(26),o()(),l(27,ue,5,1,"mat-error"),o(),d(28,"button",8),l(29,pe,1,0,"app-spinner")(30,ge,2,0,"span"),o()()()()),m&2&&(h("ngClass",n.role==="admin"?"admin-container-div":"container-div"),s(),h("ngClass",n.role==="admin"?"content-div":""),s(5),h("formGroup",n.changePasswordForm),s(5),c(n.changePasswordForm.get("email").invalid&&n.changePasswordForm.get("email").touched?11:-1),s(4),h("type",n.hideCurrentPassword?"password":"text"),s(3),b(n.hideCurrentPassword?"visibility_off":"visibility"),s(),c(n.changePasswordForm.get("currentPassword").invalid&&n.changePasswordForm.get("currentPassword").touched?19:-1),s(4),h("type",n.hideNewPassword?"password":"text"),s(3),b(n.hideNewPassword?"visibility_off":"visibility"),s(),c(n.changePasswordForm.get("newPassword").invalid&&n.changePasswordForm.get("newPassword").touched?27:-1),s(),h("disabled",n.loading),s(),c(n.loading?29:30))},dependencies:[I,T,G,R,k,q,D,L,A,V,K,ee,Y,Q,W,X,j,Z,$,ne,te,J,H],styles:[".container-div[_ngcontent-%COMP%]{padding:2rem;background-color:#fff;box-shadow:0 .5rem 1rem #0000001a}.admin-container-div[_ngcontent-%COMP%]{min-height:90vh;display:flex;justify-content:center;align-items:center}.content-div[_ngcontent-%COMP%]{padding:2rem;width:30%;box-shadow:0 .5rem 1rem #0000001a;background-color:#fff}.change-password-title[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:500;display:flex;align-items:center;gap:.5rem;color:#025dad}.full-width[_ngcontent-%COMP%]{width:100%}.hideIcon[_ngcontent-%COMP%]{margin-right:1rem}.submit-button[_ngcontent-%COMP%]{text-wrap:nowrap;font-size:.875rem}@media (max-width: 480px){.container-div[_ngcontent-%COMP%]{padding:1.5rem}.content-div[_ngcontent-%COMP%]{padding:1.5rem;width:60%}.change-password-title[_ngcontent-%COMP%]{font-size:.875rem;gap:.5rem;margin-bottom:.75rem}.submit-button[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 481px) and (max-width: 768px){.container-div[_ngcontent-%COMP%]{padding:1.5rem}.content-div[_ngcontent-%COMP%]{padding:1.5rem;width:40%}.change-password-title[_ngcontent-%COMP%]{font-size:1rem;gap:.5rem;margin-bottom:.75rem}.submit-button[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 769px) and (max-width: 1024px){.container-div[_ngcontent-%COMP%]{padding:1.5rem}.content-div[_ngcontent-%COMP%]{padding:1.5rem;width:40%}.change-password-title[_ngcontent-%COMP%]{font-size:1rem;gap:.5rem;margin-bottom:1rem}.submit-button[_ngcontent-%COMP%]{font-size:.875rem}}"]});let e=t;return e})();export{De as a};
