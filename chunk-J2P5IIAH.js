import{a as xe}from"./chunk-RZO5UEUE.js";import{a as Oe}from"./chunk-RPPOXAAJ.js";import{a as he}from"./chunk-BE25XLFQ.js";import{a as ne,b as ie,c as re,d as oe,e as ae,f as me,g as le,h as de,i as ce,j as se,k as pe,l as ue,m as fe,n as E,o as _e,p as T,q as Ce,r as ge}from"./chunk-IF4R4DCX.js";import"./chunk-4RKGKIHI.js";import{a as O}from"./chunk-73G7AXVQ.js";import{a as j}from"./chunk-QXHIHSTA.js";import{A as C,Oa as Y,Ta as G,Ua as J,Va as K,Wa as W,Ya as X,ab as Z,cb as ee,db as te,pa as L,ra as q}from"./chunk-JKOZUD4R.js";import{$b as F,Bb as n,Cb as i,D as M,Db as b,Dc as B,Eb as p,Fb as u,Hb as P,Kb as w,Mb as _,Qb as R,Rb as I,Sb as A,Tb as k,Ub as o,Vb as f,W as g,Wa as l,Wb as z,ac as U,bc as Q,cc as $,da as S,ha as V,p as x,pb as d,qb as H,ra as y,rb as h,sa as v,wb as D,za as N}from"./chunk-EBQJBUXN.js";var Se=()=>[5,10,25];function be(e,t){e&1&&(n(0,"th",27),o(1,"Username"),i())}function ye(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.username||"-")}}function ve(e,t){e&1&&(n(0,"th",27),o(1,"ID"),i())}function Pe(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.employeeID||"-")}}function we(e,t){e&1&&(n(0,"th",27),o(1,"Tea Quantity"),i())}function Ee(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.teaQuantity||"-")}}function Te(e,t){e&1&&(n(0,"th",29),o(1,"Tea Amount"),i())}function De(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.teaAmount||"-")}}function Re(e,t){e&1&&(n(0,"th",27),o(1,"Coffee Quantity"),i())}function Ie(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.coffeeQuantity||"-")}}function Ae(e,t){e&1&&(n(0,"th",29),o(1,"Coffee Amount"),i())}function ke(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.coffeeAmount||"-")}}function ze(e,t){e&1&&(n(0,"th",29),o(1,"Notes"),i())}function Qe(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.notes||"-")}}function $e(e,t){e&1&&(n(0,"th",27),o(1,"Room Number"),i())}function Ve(e,t){if(e&1&&(n(0,"td",28),o(1),i()),e&2){let r=t.$implicit;l(),f(r.roomNumber||"-")}}function Ne(e,t){e&1&&(n(0,"th",27),o(1,"Created At"),i())}function He(e,t){if(e&1&&(n(0,"td",28),o(1),Q(2,"timesAgo"),i()),e&2){let r=t.$implicit;l(),f($(2,1,r.createdAt))}}function Fe(e,t){e&1&&(n(0,"th",27),o(1,"Order Status"),i())}function Ue(e,t){if(e&1&&(n(0,"td",28),o(1),Q(2,"titlecase"),i()),e&2){let r=t.$implicit;l(),z(" ",$(2,1,r.orderStatus)," ")}}function Be(e,t){e&1&&(n(0,"th",29),o(1,"Actions"),i())}function je(e,t){if(e&1){let r=P();n(0,"button",34),w("click",function(){y(r);let m=_().$implicit,c=_();return v(m.orderStatus==="in progress"?c.completeOrder(m._id):c.approveOrder(m._id))}),n(1,"mat-icon"),o(2),i(),n(3,"span",33),o(4),i()()}if(e&2){let r=_().$implicit;l(2),f(r.orderStatus==="in progress"?"done_all":"check_circle"),l(2),f(r.orderStatus==="in progress"?"Delivered":"Approve")}}function Le(e,t){if(e&1){let r=P();n(0,"td",30),d(1,je,5,2,"button",31),n(2,"button",32),w("click",function(){let m=y(r).$implicit,c=_();return v(c.cancelOrder(m._id))}),n(3,"mat-icon"),o(4,"cancel"),i(),n(5,"span",33),o(6,"Cancel"),i()()()}if(e&2){let r=t.$implicit,a=_();l(),D(a.role!=="employee"?1:-1),l(),h("disabled",r.orderStatus==="in progress"&&a.role==="employee")}}function qe(e,t){e&1&&(n(0,"div",36),b(1,"app-spinner"),i())}function Ye(e,t){if(e&1&&(n(0,"div",37),o(1),i()),e&2){_(2);let r=k(11);l(),z(' No data matching for the filter "',r.value,'" ')}}function Ge(e,t){e&1&&(n(0,"div",37)(1,"mat-icon"),o(2,"search_off"),i(),n(3,"div"),o(4,"No orders found"),i()())}function Je(e,t){if(e&1&&(n(0,"tr",35)(1,"td"),d(2,qe,2,0,"div",36)(3,Ye,2,1,"div",37)(4,Ge,5,0,"div",37),i()()),e&2){let r=_(),a=k(11);l(),H("colspan",r.displayedColumns.length),l(),D(r.loading?2:a.value?3:4)}}function Ke(e,t){e&1&&b(0,"tr",38)}function We(e,t){e&1&&b(0,"tr",39)}var Pt=(()=>{let t=class t{constructor(){this.dialog=S(Y),this.orderService=S(Oe),this.authService=S(j),this.destroyRef=S(N),this.role="",this.loading=!0,this.displayedColumns=[],this.dataSource=new fe}ngOnInit(){this.checkRole(),this.setUpTableColumn(),this.getOrders(),this.initializeOrderUpdates()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}checkRole(){this.authService.getRole().pipe(g(a=>this.role=a),C(this.destroyRef)).subscribe()}setUpTableColumn(){this.displayedColumns=this.role!=="employee"?["username","id","teaQuantity","teaAmount","coffeeQuantity","coffeeAmount","notes","roomNumber","createdAt","orderStatus","actions"]:["teaQuantity","teaAmount","coffeeQuantity","coffeeAmount","notes","roomNumber","createdAt","orderStatus","actions"]}getOrders(){this.orderService.getCurrentOrders().pipe(g(a=>{this.dataSource.data=a,this.loading=!1}),M(a=>(O(this.dialog,a.error.message,"close"),console.log(a),this.loading=!1,x([]))),C(this.destroyRef)).subscribe()}initializeOrderUpdates(){this.orderService.getOrderUpdates().pipe(C(this.destroyRef)).subscribe(()=>{this.getOrders()})}approveOrder(a){this.orderService.aprroveOrder(a).pipe(g(()=>{this.getOrders()}),M(m=>(O(this.dialog,m.error.message,"close"),console.log(m),x(m))),C(this.destroyRef)).subscribe()}completeOrder(a){this.orderService.completeOrder(a).pipe(g(()=>{this.getOrders()}),M(m=>(O(this.dialog,m.error.message,"close"),console.log(m),x(m))),C(this.destroyRef)).subscribe()}cancelOrder(a){this.dialog.open(he,{width:"300px",data:{message:"Are you sure you want to cancel this order?",confirmButtonLabel:"Yes",cancelButtonLabel:"No"}}).afterClosed().subscribe(c=>{c==="confirm"&&this.orderService.cancelOrder(a,this.role).pipe(g(s=>{this.getOrders(),O(this.dialog,s.message,"close")}),M(s=>(O(this.dialog,s.error.message,"close"),console.log(s),x(s))),C(this.destroyRef)).subscribe()})}applyFilter(a){let m=a.target.value;this.dataSource.filter=m.trim().toLowerCase()}};t.\u0275fac=function(m){return new(m||t)},t.\u0275cmp=V({type:t,selectors:[["app-current-orders"]],viewQuery:function(m,c){if(m&1&&(R(E,5),R(T,5)),m&2){let s;I(s=A())&&(c.paginator=s.first),I(s=A())&&(c.sort=s.first)}},standalone:!0,features:[F],decls:51,vars:5,consts:[["input",""],[1,"container"],[1,"title"],[1,"filter"],["matIconPrefix",""],["matInput","",3,"keyup"],[1,"table-container"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","username"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","id"],["matColumnDef","teaQuantity"],["matColumnDef","teaAmount"],["mat-header-cell","",4,"matHeaderCellDef"],["matColumnDef","coffeeQuantity"],["matColumnDef","coffeeAmount"],["matColumnDef","notes"],["matColumnDef","roomNumber"],["matColumnDef","createdAt"],["matColumnDef","orderStatus"],["matColumnDef","actions"],["mat-cell","","class","actions-cell",4,"matCellDef"],["class","no-data-row",4,"matNoDataRow"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["aria-label","Select page of orders",3,"pageSizeOptions"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-cell","",1,"actions-cell"],["mat-flat-button","","color","primary"],["mat-flat-button","","color","warn",3,"click","disabled"],[1,"button-text"],["mat-flat-button","","color","primary",3,"click"],[1,"no-data-row"],[1,"spinner"],[1,"no-data-content"],["mat-header-row",""],["mat-row",""]],template:function(m,c){if(m&1){let s=P();n(0,"div",1)(1,"div",2)(2,"mat-icon"),o(3,"shopping_cart"),i(),o(4," Current Orders"),i(),n(5,"mat-form-field",3)(6,"mat-icon",4),o(7,"filter_alt"),i(),n(8,"mat-label"),o(9,"Filter"),i(),n(10,"input",5,0),w("keyup",function(Me){return y(s),v(c.applyFilter(Me))}),i()(),n(12,"div",6)(13,"table",7),p(14,8),d(15,be,2,0,"th",9)(16,ye,2,1,"td",10),u(),p(17,11),d(18,ve,2,0,"th",9)(19,Pe,2,1,"td",10),u(),p(20,12),d(21,we,2,0,"th",9)(22,Ee,2,1,"td",10),u(),p(23,13),d(24,Te,2,0,"th",14)(25,De,2,1,"td",10),u(),p(26,15),d(27,Re,2,0,"th",9)(28,Ie,2,1,"td",10),u(),p(29,16),d(30,Ae,2,0,"th",14)(31,ke,2,1,"td",10),u(),p(32,17),d(33,ze,2,0,"th",14)(34,Qe,2,1,"td",10),u(),p(35,18),d(36,$e,2,0,"th",9)(37,Ve,2,1,"td",10),u(),p(38,19),d(39,Ne,2,0,"th",9)(40,He,3,3,"td",10),u(),p(41,20),d(42,Fe,2,0,"th",9)(43,Ue,3,3,"td",10),u(),p(44,21),d(45,Be,2,0,"th",14)(46,Le,7,2,"td",22),u(),d(47,Je,5,2,"tr",23)(48,Ke,1,0,"tr",24)(49,We,1,0,"tr",25),i(),b(50,"mat-paginator",26),i()()}m&2&&(l(13),h("dataSource",c.dataSource),l(35),h("matHeaderRowDef",c.displayedColumns),l(),h("matRowDefColumns",c.displayedColumns),l(),h("pageSizeOptions",U(4,Se)))},dependencies:[ue,ne,re,le,oe,ie,de,ae,me,ce,se,pe,ge,T,Ce,_e,E,J,G,q,L,B,xe,K,te,ee,Z,W,X],styles:[".container[_ngcontent-%COMP%]{padding:1.5rem 2rem}.title[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-bottom:1rem;background-color:#024988;color:#f0eeee;font-size:1.25rem;padding:.5rem;gap:.5rem;font-weight:500}.filter[_ngcontent-%COMP%]{width:100%}.table-container[_ngcontent-%COMP%]{box-shadow:0 .5rem 1rem #0000001a;padding:1rem;overflow-x:auto;background-color:#fff}.table-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#024988;color:#fff}.table-container[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background-color:#f2f2f2}.table-container[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd)   td[_ngcontent-%COMP%]{background-color:#f9f9f9}.table-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{color:#000;background-color:#fff}.actions-cell[_ngcontent-%COMP%]{display:flex;padding:.5rem;gap:.25rem}.spinner[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:.5rem}.no-data-row[_ngcontent-%COMP%]   .no-data-content[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:.25rem;font-weight:500;padding:.5rem}@media (max-width: 480px){.container[_ngcontent-%COMP%]{padding:1rem 1.75rem}.title[_ngcontent-%COMP%]{margin-bottom:.5rem;font-size:.875rem;padding:.25rem;gap:.25rem}.table-container[_ngcontent-%COMP%]{padding:.5rem}.table-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem}.table-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{font-size:.625rem}.button-text[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 481px) and (max-width: 768px){.container[_ngcontent-%COMP%]{padding:1.5rem}.title[_ngcontent-%COMP%]{margin-bottom:.75rem;font-size:1rem;padding:.25rem;gap:.5rem}.table-container[_ngcontent-%COMP%]{padding:.75rem}.table-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem}.table-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{font-size:.625rem}.button-text[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 769px) and (max-width: 1024px){.container[_ngcontent-%COMP%]{padding:1.5rem}.title[_ngcontent-%COMP%]{margin-bottom:.75rem;font-size:1rem;padding:.25rem;gap:.5rem}.table-container[_ngcontent-%COMP%]{padding:.75rem}.table-container[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.75rem;padding:.5rem}.table-container[_ngcontent-%COMP%]   mat-paginator[_ngcontent-%COMP%]{font-size:.75rem}.button-text[_ngcontent-%COMP%]{font-size:.75rem}}"]});let e=t;return e})();export{Pt as CurrentOrdersComponent};
