import{a as K}from"./chunk-S34G7OME.js";import{a as R}from"./chunk-AB2WVV2A.js";import{b as ee}from"./chunk-AGNVOT4A.js";import{a as C}from"./chunk-QS4TB3GR.js";import{a as te,b as ie}from"./chunk-DQVMZKPK.js";import{Aa as U,Fa as $,Ga as J,Ha as Q,Ia as X,La as Y,Ma as Z,a as O,aa as G,ea as W,g as L,ga as H,i as g,k as z,l as N,n as T,p as q,q as A,r as j,s as B,t as V,u as k}from"./chunk-VPTYPPTQ.js";import{Ab as o,Bb as e,Cb as F,Cc as D,D as v,Db as b,Eb as M,Jb as x,Tb as r,W as h,Wa as l,Xb as E,Z as _,a as S,da as s,ha as y,p as I,pb as d,rb as c,xc as P,za as w}from"./chunk-BTNHTO55.js";var ne=(()=>{let i=class i{constructor(){this.http=s(O),this.API=L.apiUrl}dailyCheckIn(t){return this.http.post(`${this.API}/user/checkin`,t)}getCheckInStatus(){return this.http.get(`${this.API}/user/checkIn-status`)}};i.\u0275fac=function(a){return new(a||i)},i.\u0275prov=_({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();function re(n,i){n&1&&(o(0,"mat-option",16),r(1,"Work From Home"),e())}function ae(n,i){n&1&&(o(0,"mat-error"),r(1," Work Location is required "),e())}function me(n,i){n&1&&(o(0,"mat-error"),r(1," Meal is required "),e())}function le(n,i){n&1&&(o(0,"mat-error"),r(1," Snacks is required "),e())}function ce(n,i){n&1&&(b(0),F(1,"app-spinner"),M())}function se(n,i){n&1&&(b(0),o(1,"span"),r(2,"Save"),e(),M())}var Ae=(()=>{let i=class i{constructor(){this.authService=s(R),this.dailyCheckInService=s(ne),this.formBuilder=s(j),this.dialog=s(U),this.destroyRef=s(w),this.loading=!1,this.role=""}ngOnInit(){this.checkRole(),this.getCurrentPreference(),this.initializeForm()}checkRole(){this.authService.getRole().pipe(h(t=>this.role=t),k(this.destroyRef)).subscribe()}initializeForm(){this.checkInForm=this.formBuilder.group({workLocation:["",g.required],meal:[{value:"",disabled:!0},g.required],snacks:[{value:"",disabled:!0},g.required]}),this.checkInForm.get("workLocation")?.valueChanges.subscribe(t=>{this.toggleMealState(t)})}toggleMealState(t){let a=this.checkInForm.get("meal"),m=this.checkInForm.get("snacks");t==="wfh"||t==="leave"?(a?.disable(),a?.setValue(""),m?.disable(),m?.setValue("")):(a?.enable(),m?.enable())}getCurrentPreference(){this.dailyCheckInService.getCheckInStatus().pipe(h(t=>{this.currentPreference=t,this.currentPreference&&this.updateForm()}),v(t=>(this.loading=!1,C(this.dialog,t.error.message,"close"),console.log(t),I(t))),k(this.destroyRef)).subscribe()}updateForm(){this.currentPreference&&(this.checkInForm.patchValue({meal:this.currentPreference.meal,snacks:this.currentPreference.snacks,workLocation:this.currentPreference.workLocation}),this.toggleMealState(this.currentPreference.workLocation))}onSubmit(){if(this.checkInForm.markAllAsTouched(),this.checkInForm.valid){let t=S({},this.checkInForm.value);(t.workLocation==="wfh"||t.workLocation==="leave")&&(t.meal=""),this.dailyCheckInService.dailyCheckIn(t).pipe(h(a=>{this.loading=!1,C(this.dialog,a.message,"close")}),v(a=>(this.loading=!1,C(this.dialog,a.error.message,"close"),console.log(a),I(a))),k(this.destroyRef)).subscribe()}}};i.\u0275fac=function(a){return new(a||i)},i.\u0275cmp=y({type:i,selectors:[["app-daily-check-in"]],standalone:!0,features:[E],decls:40,vars:8,consts:[[1,"container"],[1,"form-wrapper"],[1,"form-title"],[3,"ngSubmit","formGroup"],[1,"full-width"],["formControlName","workLocation","id","workLocation"],["value","mohakhali"],["value","mirpur"],["value","leave"],["value","wfh",4,"ngIf"],[4,"ngIf"],["formControlName","meal","id","meal"],["value","regular"],["value","diet"],["formControlName","snacks","id","snacks"],["mat-flat-button","","type","submit",1,"submit-button",3,"disabled"],["value","wfh"]],template:function(a,m){if(a&1&&(o(0,"div",0)(1,"div",1)(2,"p",2)(3,"mat-icon"),r(4,"today"),e(),r(5," Daily Check In"),e(),o(6,"form",3),x("ngSubmit",function(){return m.onSubmit()}),o(7,"mat-form-field",4)(8,"mat-label"),r(9,"Work Location"),e(),o(10,"mat-select",5)(11,"mat-option",6),r(12,"Mohakhali"),e(),o(13,"mat-option",7),r(14,"Mirpur"),e(),o(15,"mat-option",8),r(16,"On Leave"),e(),d(17,re,2,0,"mat-option",9),e(),d(18,ae,2,0,"mat-error",10),e(),o(19,"mat-form-field",4)(20,"mat-label"),r(21,"Meal"),e(),o(22,"mat-select",11)(23,"mat-option",12),r(24,"Regular"),e(),o(25,"mat-option",13),r(26,"Diet"),e()(),d(27,me,2,0,"mat-error",10),e(),o(28,"mat-form-field",4)(29,"mat-label"),r(30,"Snacks"),e(),o(31,"mat-select",14)(32,"mat-option",12),r(33,"Regular"),e(),o(34,"mat-option",13),r(35,"Diet"),e()(),d(36,le,2,0,"mat-error",10),e(),o(37,"button",15),d(38,ce,2,0,"ng-container",10)(39,se,3,0,"ng-container",10),e()()()()),a&2){let p,f,u;l(6),c("formGroup",m.checkInForm),l(11),c("ngIf",m.role!=="staff"),l(),c("ngIf",((p=m.checkInForm.get("workLocation"))==null?null:p.invalid)&&((p=m.checkInForm.get("workLocation"))==null?null:p.touched)),l(9),c("ngIf",((f=m.checkInForm.get("meal"))==null?null:f.invalid)&&((f=m.checkInForm.get("meal"))==null?null:f.touched)),l(9),c("ngIf",((u=m.checkInForm.get("snacks"))==null?null:u.invalid)&&((u=m.checkInForm.get("snacks"))==null?null:u.touched)),l(),c("disabled",m.loading),l(),c("ngIf",m.loading),l(),c("ngIf",!m.loading)}},dependencies:[D,P,B,T,z,N,V,q,A,K,Z,Y,Q,X,ee,ie,te,G,H,W,J,$],styles:[".container[_ngcontent-%COMP%]{min-height:90vh;display:flex;justify-content:center;align-items:center}.form-wrapper[_ngcontent-%COMP%]{padding:2rem;width:30%;background-color:#fff;box-shadow:0 .5rem 1rem #0000001a}.form-title[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:1.25rem;gap:.5rem;font-weight:500;color:#025dad}.full-width[_ngcontent-%COMP%]{width:100%}.submit-button[_ngcontent-%COMP%]{font-size:.875rem;text-wrap:nowrap}@media (max-width: 480px){.form-wrapper[_ngcontent-%COMP%]{padding:1.5rem;width:50%}.form-title[_ngcontent-%COMP%]{font-size:.875rem;gap:.5rem;margin-bottom:.75rem}.submit-button[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 481px) and (max-width: 768px){.form-wrapper[_ngcontent-%COMP%]{padding:1.5rem;width:40%}.form-title[_ngcontent-%COMP%]{font-size:1rem;gap:.5rem;margin-bottom:.75rem}.submit-button[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 769px) and (max-width: 1024px){.form-wrapper[_ngcontent-%COMP%]{padding:1.5rem;width:40%}.form-title[_ngcontent-%COMP%]{font-size:1.25rem;gap:.5rem;margin-bottom:1rem}.submit-button[_ngcontent-%COMP%]{font-size:.875rem}}"]});let n=i;return n})();export{Ae as DailyCheckInComponent};
