import{a as z}from"./chunk-6GFOBDWL.js";import{b as ne}from"./chunk-IH3R4FBH.js";import{a as S}from"./chunk-FQON5K5U.js";import{a as ie,b as oe}from"./chunk-2BGQ2KSS.js";import{Aa as J,Fa as K,Ga as Q,Ha as X,Ia as Y,Ja as Z,Ma as ee,Na as te,a as T,aa as H,ea as U,g as R,ga as $,i as v,k as q,l as N,n as A,p as j,q as B,r as V,s as G,t as W,u as I}from"./chunk-YPECUWCB.js";import{Bb as o,Bc as O,Cb as i,D as M,Db as P,Eb as C,Fb as k,Kb as D,Mb as _,Ub as r,W as g,Wa as c,Yb as L,Z as y,a as w,da as u,ha as F,p as b,pb as s,rb as x,wb as d,za as E}from"./chunk-6L47HEBJ.js";var re=(()=>{let n=class n{constructor(){this.http=u(T),this.API=R.apiUrl}dailyCheckIn(t){return this.http.post(`${this.API}/user/checkin`,t)}getCheckInStatus(){return this.http.get(`${this.API}/user/checkIn-status`)}};n.\u0275fac=function(a){return new(a||n)},n.\u0275prov=y({token:n,factory:n.\u0275fac,providedIn:"root"});let e=n;return e})();function le(e,n){e&1&&(o(0,"mat-option",9),r(1,"Work From Home"),i())}function me(e,n){e&1&&(C(0),r(1,"Work Location is required"),k())}function ce(e,n){if(e&1&&(o(0,"mat-error"),s(1,me,2,0,"ng-container"),i()),e&2){let m,t=_();c(),d(!((m=t.checkInForm.get("worLocation"))==null||m.errors==null)&&m.errors.required?1:-1)}}function se(e,n){e&1&&(C(0),r(1,"Meal Location is required"),k())}function de(e,n){if(e&1&&(o(0,"mat-error"),s(1,se,2,0,"ng-container"),i()),e&2){let m,t=_();c(),d(!((m=t.checkInForm.get("meal"))==null||m.errors==null)&&m.errors.required?1:-1)}}function ue(e,n){e&1&&(C(0),r(1,"Snacks Location is required"),k())}function pe(e,n){if(e&1&&(o(0,"mat-error"),s(1,ue,2,0,"ng-container"),i()),e&2){let m,t=_();c(),d(!((m=t.checkInForm.get("snacks"))==null||m.errors==null)&&m.errors.required?1:-1)}}function he(e,n){e&1&&P(0,"app-spinner")}function fe(e,n){e&1&&(o(0,"span"),r(1,"Save"),i())}var Ge=(()=>{let n=class n{constructor(){this.authService=u(z),this.dailyCheckInService=u(re),this.formBuilder=u(V),this.dialog=u(J),this.destroyRef=u(E),this.loading=!1,this.role=""}ngOnInit(){this.checkRole(),this.initializeForm(),this.getCurrentPreference()}checkRole(){this.authService.getRole().pipe(g(t=>this.role=t),I(this.destroyRef)).subscribe()}initializeForm(){this.checkInForm=this.formBuilder.group({workLocation:["",v.required],meal:[{value:"",disabled:!0},v.required],snacks:[{value:"",disabled:!0},v.required]}),this.checkInForm.get("workLocation")?.valueChanges.subscribe(t=>{this.toggleMealState(t)})}toggleMealState(t){let a=this.checkInForm.get("meal"),l=this.checkInForm.get("snacks");t==="wfh"||t==="leave"?(a?.disable(),a?.setValue(""),l?.disable(),l?.setValue("")):(a?.enable(),l?.enable())}getCurrentPreference(){this.dailyCheckInService.getCheckInStatus().pipe(g(t=>{this.currentPreference=t,this.currentPreference&&this.updateForm()}),M(t=>(S(this.dialog,t.error.message,"close"),console.log(t),b(t))),I(this.destroyRef)).subscribe()}updateForm(){this.currentPreference&&(this.checkInForm.patchValue({meal:this.currentPreference.meal,snacks:this.currentPreference.snacks,workLocation:this.currentPreference.workLocation}),this.toggleMealState(this.currentPreference.workLocation))}onSubmit(){if(this.checkInForm.markAllAsTouched(),this.checkInForm.valid){this.loading=!0;let t=w({},this.checkInForm.value);(t.workLocation==="wfh"||t.workLocation==="leave")&&(t.meal=""),this.dailyCheckInService.dailyCheckIn(t).pipe(g(a=>{this.loading=!1,S(this.dialog,a.message,"close")}),M(a=>(this.loading=!1,S(this.dialog,a.error.message,"close"),console.log(a),b(a))),I(this.destroyRef)).subscribe()}}};n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=F({type:n,selectors:[["app-daily-check-in"]],standalone:!0,features:[L],decls:40,vars:7,consts:[[1,"container"],[1,"form-wrapper"],[1,"form-title"],[3,"ngSubmit","formGroup"],[1,"full-width"],["formControlName","workLocation","id","workLocation"],["value","mohakhali"],["value","mirpur"],["value","leave"],["value","wfh"],["formControlName","meal","id","meal"],["value","regular"],["value","diet"],["formControlName","snacks","id","snacks"],["mat-flat-button","","type","submit",1,"submit-button",3,"disabled"]],template:function(a,l){if(a&1&&(o(0,"div",0)(1,"div",1)(2,"p",2)(3,"mat-icon"),r(4,"today"),i(),r(5," Daily Check In"),i(),o(6,"form",3),D("ngSubmit",function(){return l.onSubmit()}),o(7,"mat-form-field",4)(8,"mat-label"),r(9,"Work Location"),i(),o(10,"mat-select",5)(11,"mat-option",6),r(12,"Mohakhali"),i(),o(13,"mat-option",7),r(14,"Mirpur"),i(),o(15,"mat-option",8),r(16,"On Leave"),i(),s(17,le,2,0,"mat-option",9),i(),s(18,ce,2,1,"mat-error"),i(),o(19,"mat-form-field",4)(20,"mat-label"),r(21,"Meal"),i(),o(22,"mat-select",10)(23,"mat-option",11),r(24,"Regular"),i(),o(25,"mat-option",12),r(26,"Diet"),i()(),s(27,de,2,1,"mat-error"),i(),o(28,"mat-form-field",4)(29,"mat-label"),r(30,"Snacks"),i(),o(31,"mat-select",13)(32,"mat-option",11),r(33,"Regular"),i(),o(34,"mat-option",12),r(35,"Diet"),i()(),s(36,pe,2,1,"mat-error"),i(),o(37,"button",14),s(38,he,1,0,"app-spinner")(39,fe,2,0,"span"),i()()()()),a&2){let p,h,f;c(6),x("formGroup",l.checkInForm),c(11),d(l.role!=="staff"?17:-1),c(),d((p=l.checkInForm.get("workLocation"))!=null&&p.invalid&&((p=l.checkInForm.get("workLocation"))!=null&&p.touched)?18:-1),c(9),d((h=l.checkInForm.get("meal"))!=null&&h.invalid&&((h=l.checkInForm.get("meal"))!=null&&h.touched)?27:-1),c(9),d((f=l.checkInForm.get("snacks"))!=null&&f.invalid&&((f=l.checkInForm.get("snacks"))!=null&&f.touched)?36:-1),c(),x("disabled",l.loading),c(),d(l.loading?38:39)}},dependencies:[O,G,A,q,N,W,j,B,X,te,ee,Y,Z,ne,oe,ie,H,$,U,Q,K],styles:[".container[_ngcontent-%COMP%]{min-height:90vh;display:flex;justify-content:center;align-items:center}.form-wrapper[_ngcontent-%COMP%]{padding:2rem;width:30%;background-color:#fff;box-shadow:0 .5rem 1rem #0000001a}.form-title[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:1.25rem;gap:.5rem;font-weight:500;color:#025dad}.full-width[_ngcontent-%COMP%]{width:100%}.submit-button[_ngcontent-%COMP%]{font-size:.875rem;text-wrap:nowrap}@media (max-width: 480px){.form-wrapper[_ngcontent-%COMP%]{padding:1.5rem;width:50%}.form-title[_ngcontent-%COMP%]{font-size:.875rem;gap:.5rem;margin-bottom:.75rem}.submit-button[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 481px) and (max-width: 768px){.form-wrapper[_ngcontent-%COMP%]{padding:1.5rem;width:40%}.form-title[_ngcontent-%COMP%]{font-size:1rem;gap:.5rem;margin-bottom:.75rem}.submit-button[_ngcontent-%COMP%]{font-size:.75rem}}@media (min-width: 769px) and (max-width: 1024px){.form-wrapper[_ngcontent-%COMP%]{padding:1.5rem;width:40%}.form-title[_ngcontent-%COMP%]{font-size:1.25rem;gap:.5rem;margin-bottom:1rem}.submit-button[_ngcontent-%COMP%]{font-size:.875rem}}"]});let e=n;return e})();export{Ge as DailyCheckInComponent};
